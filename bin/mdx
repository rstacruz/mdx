#!/usr/bin/env node

var Extractor = require('../index').Extractor;

if (!process.parent) run();

/**
 * Runs.
 */

function run() {
  var read = require('read-input');
  var argv = require('yargs').argv;
  var ex = new Extractor();

  read(argv._).then(function (res) {
    // non-fatal errors
    if (res.error) console.warn(res.error.message);
    
    res.files.forEach(function (f) {
      ex.push(f.name, f.data);
    });

    console.log(JSON.stringify(ex.toJson(), null, 2));

  }).catch(function (err) {
    throw err;
  });
}
